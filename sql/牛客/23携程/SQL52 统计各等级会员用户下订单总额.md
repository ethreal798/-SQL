# 条件函数

***\*SQL52 统计各等级会员用户下订单总额\****

### 做什么 关联两表进行分组 并对字段求和

请统计每个会员等级的订单总额。

要求输出：会员等级，订单总额

注：如果存在某一会员等级的用户没有下订单也需要输出该会员等级，订单总额记录为0，

输出结果按照订单总额降序排序

示例数据结果如下：

| vip      | order_total |
| -------- | ----------- |
| 钻石会员 | 1550        |
| 金卡会员 | 640         |
| 银行会员 | 540         |
| 普通会员 | 0           |

结果解释：

由用户会员等级信息表可知，钻石会员用户有12，该用户这几日共计下订单总额为1550，其他结果同理；

其中普通会员用户14、16没有下订单，故订单总额为0。

### 怎么做

- 这里要注意 使用什么进行表关联 如果我们只是用join on user_id，会导致普通会员的行被筛掉 所以我们使用的是 left join on 
- 因为没有匹配的行，所以普通会员的订单总额字段是 null 如果我们求和得到的也是null 这里我们就需要使用if 条件  进行控制

### 代码展示

```
select 
u.vip , 
if(sum(o.order_price) >0 ,sum(o.order_price),0 ) order_total
from uservip_tb u
left join 
    order_tb o
on o.user_id = u.user_id
group by u.vip
order by order_total desc
```